<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Page</title>
    <link rel="shortcut icon" href="\assets\images\favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/css/main.css" type="text/css">
    <script src="/javascript/main.js"></script>   
    <style>
        main {
            text-align: center;
        }
    </style>           
</head>
<body>
    <header>
        <nav class="nav-bar">
            <ul class="nav-list">
                <a id="home-button" href="/html/index.html">
                    <li>
                        Home
                    </li>
                </a>
                <a id="portfolio-button" href="/html/portfolio.html">
                    <li>
                        Portfolio
                    </li>
                </a>
                <a id="aboutMe-button" href="/html/about-me.html">
                    <li>
                        About Me
                    </li>
                </a>
                <a id="contact-button" href="/html/contact.html">
                    <li>
                        Contact
                    </li>
                </a>    
            </ul>
        </nav>
    </header>

    <main>
        <hgroup>
            <h1>Cesar's Notable Classes at UCSD</h1>
            <p>Here are a list of classes that I have taken at UCSD, including the ones important for
                my programming career as well as others that have sparked my interest.
            </p>
        </hgroup>

        <div id="load-buttons">
            <button id="load-local">Load Local</button>
            <button id="load-remote">Load Remote</button>
        </div>

        <div id="catalog">
        </div>

        <script type="module" src="/javascript/class-component.js"></script>
        <script>
            window.addEventListener('DOMContentLoaded', async () => {
                localStorage.setItem('catalog', await fetch('/json/sampledata.json').then(response => response.text()) );
            });

            const createCardButton = document.getElementById('create-card');
            const loadLocalButton = document.getElementById('load-local');
            const loadRemoteButton = document.getElementById('load-remote');
            const catalog = document.getElementById('catalog');

            loadLocalButton.addEventListener('click', () => {
                catalog.innerHTML = ''; 
                loadLocalData();
            });

            loadRemoteButton.addEventListener('click', () => {
                catalog.innerHTML = ''; 
                loadRemoteData();
            });

            createCardButton.addEventListener('click', () => {
                createNewCard();
            });
            
            function createNewCard() {
                const classCard = document.createElement('class-card');
                
                classCard.setAttribute("code", "CODE");
                classCard.setAttribute("field", "FIELD");
                classCard.setAttribute("name", "CLASS NAME");
                classCard.setAttribute("image", "\assets\images\placeholder-image.png");
                classCard.setAttribute("note", "This is a newly created class card. Edit to add details.");
                classCard.setAttribute("link", "https://www.example.com");
                catalog.appendChild(classCard);
            }

            function loadLocalData() {
                const data = JSON.parse(localStorage.getItem('catalog'));
                for (const key in data) {
                    const classInfo = data[key];
                    const classCard = document.createElement('class-card');
                    
                    classCard.setAttribute("code", classInfo.code);
                    classCard.setAttribute("field", classInfo.field);
                    classCard.setAttribute("name", classInfo.name);
                    classCard.setAttribute("image", classInfo.image);
                    classCard.setAttribute("note", classInfo.note);
                    classCard.setAttribute("link", classInfo.link);
                    catalog.appendChild(classCard);
                }
            }

            async function loadRemoteData() {
                const url = "https://api.jsonbin.io/v3/b/69322020d0ea881f40137d1e";
                let records = {}

                
                // Attempt to get data from remote resource (I am use fetch in this case)
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`Response status: ${response.status}`);
                }

                const jsonData = await response.json();
                // if you use my json server make sure the .record part is removed
                records = jsonData.record;

                for (const key in records) {
                    const classInfo = records[key];
                    const classCard = document.createElement('class-card');
                    
                    classCard.setAttribute("code", classInfo.code);
                    classCard.setAttribute("field", classInfo.field);
                    classCard.setAttribute("name", classInfo.name);
                    classCard.setAttribute("image", classInfo.image);
                    classCard.setAttribute("note", classInfo.note);
                    classCard.setAttribute("link", classInfo.link);
                    catalog.appendChild(classCard);
                }
            }
        </script>

    </main>

    <footer>
        <button id="theme-toggle">ðŸŒ™ Dark Mode</button> 
        <noscript>This button doesn't work without Javascript.</noscript>
    </footer>

    <noscript>
        <p>You have Javascript disabled or are using a browser that does not support Javascript.</p>
    </noscript>
</body>
</html>